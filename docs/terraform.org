#+TITLE: Mina Terraform Scripts
#+AUTHOR: Trevor Bernard
#+EMAIL: trevor@granola.team
#+LANGUAGE: en

* AWS Mina Infrastructure

** Terraform tfstate backend storage

*** Terraform policy and Roles

Add the following IAM policies to the terraform user

- s3:ListBucket on arn:aws:s3:::mybucket
- s3:GetObject on arn:aws:s3:::mybucket/path/to/my/key
- s3:PutObject on arn:aws:s3:::mybucket/path/to/my/key
- s3:DeleteObject on arn:aws:s3:::mybucket/path/to/my/key

#+begin_src javascript
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "s3:ListBucket",
        "Resource": "arn:aws:s3:::mybucket"
      },
      {
        "Effect": "Allow",
        "Action": ["s3:GetObject", "s3:PutObject", "s3:DeleteObject"],
        "Resource": "arn:aws:s3:::mybucket/path/to/my/key"
      }
    ]
  }
#+end_src

*** Interesting Links

[[https://developer.hashicorp.com/terraform/language/settings/backends/s3][S3 tfstate backend]]

#+begin_src terraform
  terraform {
    backend "s3" {
      bucket = "mybucket"
      key    = "path/to/my/key"
      region = "ca-central-1"
    }
  }
#+end_src

** New AWS Organiation

#+begin_src fundamental
  arn:aws:organizations::154664751924:account/o-yfvkydeybn/192863802010
#+end_src

** Network

*** VPC

*** Private Subnet

*** Public Subnet

** AWS ECS Cluster

[[https://dev.to/thnery/create-an-aws-ecs-cluster-using-terraform-g80][Create an ECS Cluster Using Terraform]]
